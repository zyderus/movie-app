console.log("startup.js");const userTheme=getCookie("theme")||null;let currentTheme=document.documentElement.getAttribute("data-theme");console.log("theme",currentTheme);const toggleSwitch=document.querySelector(".theme-checkbox"),supportedLangs=["en","ru","es"];let locale=getLocale(supportedLangs);const language=locale,cacheInterval=36e5;let coordinates;function getCookie(e){const t=e+"=",a=document.cookie.split(";");for(let e=0;e<a.length;e++){let n=a[e];for(;" "==n.charAt(0);)n=n.substring(1);if(0==n.indexOf(t))return n.substring(t.length,n.length)}return""}function getLocale(e){let t;if(getCookie("language")){t=e.indexOf(getCookie("language"))>=0?getCookie("language"):"en"}else t=navigator.languages[0].substring(0,2);return t}console.log("utilities.js");const timeFormat=e=>{let t=e.getHours().toString(),a=e.getMinutes().toString();return t=n(t),a=n(a),parseInt(t+a);function n(e){return e<10?e="0"+e:e}},conditionTheme=(e,t)=>{const a=timeFormat(new Date);a>e&&a<t?dayTheme():nightTheme()},dayTheme=()=>{document.documentElement.setAttribute("data-theme","light"),toggleSwitch.checked=!1,currentTheme="light"},nightTheme=()=>{document.documentElement.setAttribute("data-theme","dark"),toggleSwitch.checked=!0,currentTheme="dark"},goBack=()=>{window.history.back()},writeToCache=(e,t)=>localStorage.setItem(e,JSON.stringify(t)),readFromCache=e=>JSON.parse(localStorage.getItem(e))||null,fetchFresh=async e=>{try{const t=await fetch(e),a=t.ok?t:new Error(t.statusText),n=await a.json();return n.time=Date.now(),n}catch(e){console.log("error:",e)}},fetchData=async(e,t=36e5,a=!0)=>{const n=readFromCache(e);if(n&&n.time>Date.now()-t)return n;{const t=await fetchFresh(e);return a&&t&&writeToCache(e,t),t||n}},fetchMovie=async e=>{const t=`${url_movieInfo+e}?${url_params}`;watchMovie(await fetchData(t))},getGeoip=()=>fetchData("https://freegeoip.app/json/",18e5),getLocation=async()=>new Promise(((e,t)=>{navigator.geolocation.getCurrentPosition(e,t)})),getCoords=async()=>{const e=await navigator.permissions.query({name:"geolocation"});if(!navigator.geolocation||"granted"!=e.state)return console.log("from geoIP..."),getGeoip();console.log("from navigator.geolocation...");try{const e=await getLocation();return{latitude:parseFloat(e.coords.latitude.toFixed(4)),longitude:parseFloat(e.coords.longitude.toFixed(4))}}catch(e){return console.log("ERRORS...",e),getGeoip()}},getWeather=async e=>{const t={lat:e.latitude,lon:e.longitude};coordinates=t;const a=`https://api.openweathermap.org/data/2.5/weather?lat=${t.lat}&lon=${t.lon}&units=metric&lang=ru&appid=73ccfb39651ee95f5ba9a7a7ae60941a`;return await fetchData(a)},getSunTimes=async()=>{try{const e=await getCoords(),t=await getWeather(e),a={sunrise:timeFormat(new Date(1e3*t.sys.sunrise)),sunset:timeFormat(new Date(1e3*t.sys.sunset))};return document.cookie="suntimes="+JSON.stringify(a)+"; Max-Age=86400",a}catch(e){console.log("new ERRORs...",e.message)}},clearPage=()=>{header.innerHTML="",sections.forEach((e=>{e.hasAttribute("class")&&(e.innerHTML="")}))},getClassByRate=e=>0==e?{class:"hide"}:e>=7?{class:"green",star:"fas fa-star"}:e>5?{class:"orange",star:"fas fa-star-half"}:{class:"red",star:"far fa-star"},sessionIpData=async e=>{if(sessionStorage.getItem(e)||null){return JSON.parse(sessionStorage.getItem(e))||null}{const t=await fetchFresh(e);return sessionStorage.setItem(e,JSON.stringify(t)),addtoIpHistory(t),t}};function addtoIpHistory(e){Array.prototype.pushMax=function(e,t){this.length>=t&&this.shift(),this.push(e)};const t=JSON.parse(localStorage.getItem("ipHistory"))||[];t.pushMax(e,10),localStorage.setItem("ipHistory",JSON.stringify(t))}const showMovieListGenres=e=>{const t=movieGenres.genres;let a=[];return e.map((e=>{t.map((t=>{e==t.id&&a.push(t.name)}))})),a.join(", ")},showMovieGenres=e=>{let t=[];return e.map((e=>{t.push(e.name)})),t.join(", ")};console.log("connected 1_global.js");const url_params=new URLSearchParams({language:language}),img_path="https://image.tmdb.org/t/p/w300",img_path_highres="https://image.tmdb.org/t/p/w1280",url_movie_genres="/api/movies/genres?",url_search="/api/movies/search?query=",url_theatersNow="/api/theaters/nowplaying?",url_theatersUpcoming="/api/theaters/upcoming?",url_moviesTrend="/api/movies/trending?",url_moviesPopular="/api/movies/popular?",url_movieInfo="/api/movies/movieinfo/",url_similars="/api/similar/",marqueeReel=document.querySelector(".marquee-content"),gallery=document.querySelector(".carousel-inner"),galleryThumbnails=document.querySelector(".carousel-indicators"),searchResults=document.querySelectorAll("search-results"),sections=document.querySelectorAll("section"),header=document.querySelector("header"),searchContainerMain=document.querySelector("#search-container-main"),searchForm=document.querySelector(".search-form"),searchInput=document.querySelector(".search-input"),elem=document.querySelector("elem");let movieGenres;console.log("listeners.js"),toggleSwitch.addEventListener("change",switchTheme,!1),document.querySelectorAll(".dropdown-menu").forEach((e=>{e.addEventListener("click",(e=>{e.stopPropagation()}))})),searchForm.addEventListener("submit",(async e=>{e.preventDefault();const t=searchInput.value,a=url_search+t+"&"+url_params;if(t){clearPage();const e=await fetchData(a).then((e=>e.results));toSection(document.querySelector(".search-results"),e),searchInput.value=""}})),console.log("instructions.js");const autoTheme=async()=>{const e=await getSunTimes();conditionTheme(e.sunrise,e.sunset)},setTheme=void(userTheme?getSunTimes():autoTheme());function switchTheme(e){document.querySelector("body").style.transition="background var(--transition-speed) linear",e.target.checked?(document.documentElement.setAttribute("data-theme","dark"),document.cookie="theme=dark"):(document.documentElement.setAttribute("data-theme","light"),document.cookie="theme=light")}setInterval((()=>{userTheme||autoTheme()}),9e5),"true"===sessionStorage.getItem("regformErrors")&&document.addEventListener("DOMContentLoaded",(()=>{authModal.show(),registerTab.show()})),sessionStorage.setItem("regformErrors",!1),"true"===sessionStorage.getItem("loginErrors")&&document.addEventListener("DOMContentLoaded",(()=>{authModal.show(),loginTab.show()})),sessionStorage.setItem("loginErrors",!1),"/"!=location.pathname&&document.querySelector("#auth-modal").addEventListener("hide.bs.modal",(e=>{console.log("hida maida"),window.location.href="/"})),console.log("connected 2.0_navbar.js");const langSelectors=document.querySelectorAll("#lang a"),authBtn=document.querySelector("#auth-btn"),authModal=new bootstrap.Modal(document.getElementById("auth-modal")),registerTab=new bootstrap.Tab(document.querySelector('#authTab a[href="#register-tab-page"]')),loginTab=new bootstrap.Tab(document.querySelector('#authTab a[href="#login-tab-page"]')),regbutton=document.querySelector("#btn-register"),loginbutton=document.querySelector("#btn-login"),reglink=document.querySelector("#register-link"),loginlink=document.querySelector("#login-link"),hideBtns=document.querySelectorAll(".toggle-hide");function toggleShow(e){"password"===e.previousElementSibling.type?(e.previousElementSibling.type="text",e.children[0].style.display="none",e.children[1].style.display="block"):(e.previousElementSibling.type="password",e.children[0].style.display="block",e.children[1].style.display="none")}authBtn&&authBtn.addEventListener("click",(()=>{authModal.show(),loginTab.show()})),reglink.addEventListener("click",(function(e){e.preventDefault(),registerTab.show()})),loginlink.addEventListener("click",(function(e){e.preventDefault(),loginTab.show()})),hideBtns.forEach((e=>{e.addEventListener("click",(()=>{toggleShow(e)}))}));const themeCheckbox=document.querySelector(".theme-checkbox");themeCheckbox.addEventListener("change",(()=>{document.body.classList.toggle("light")}));const langCookieAge=31536e3;langSelectors.forEach((e=>{e.addEventListener("click",(()=>{document.cookie="language="+e.id+"; max-age=31536000;path=/",location.reload()}))}));const showMegamenuMovie=e=>{const t=document.querySelector(".movie-column");if(t.innerHTML="",!e)return main.innerHTML='<div class="section-title">Movie info not available<span class="section-backlogo">Movie info not available</span></div>',!1;const{title:a,poster_path:n,vote_average:s,overview:o,release_date:r,genre_ids:i,id:l}=e,c=document.createElement("div");c.classList.add("movieCol"),c.innerHTML=`\n    \n      <div style="background-image: url('${img_path+n}'); background-size: cover; height: 250px; width: 100px"></div>\n        <div>\n          <h3>${a}</h3>\n            <span>${new Date(r).getFullYear()}</span> \n            <span class="pipe">|</span> \n            <span class="${getClassByRate(s).class}">\n              ${s} <i class="${getClassByRate(s).star}"></i></span>\n            <span class="pipe">|</span> \n            <span>${getGenres(i)}</span>\n        </div>\n        \n        <p>${o}</p>\n      </div>\n    </div>\n  `,t.appendChild(c),c.addEventListener("click",(function(){fetchMovie(l)}))};console.log("connected 4_body.js");const secTheaters=document.querySelector(".intheaters"),secTheatersPick=document.querySelector(".intheaters-pick"),secMovies=document.querySelector(".moviespopular"),secMoviesPick=document.querySelector(".moviespopular-pick"),secTv=document.querySelector(".tvpopular");async function initData(){await showGenres(),showMoviesTrending(),showInTheaters(),showMoviesPopular()}async function showGenres(){movieGenres=await fetchData(url_movie_genres+url_params,864e5),document.querySelectorAll(".genres-list").forEach((e=>{toGenresList(movieGenres.genres,e)}))}async function showInTheaters(){const e=await fetchData(url_theatersNow+url_params).then((e=>e.results)),t=await pickShow(e);toSection(secTheaters,e),toTheaterPicked(secTheatersPick,t)}async function showMoviesPopular(){const e=await fetchData(url_moviesPopular+url_params).then((e=>e.results)),t=await pickShow(e),a=await getSimilarShows(t.id,0);toSection(secMovies,e);toSimilars(toMoviePicked(secMoviesPick,t),a)}function pickShow(e){return e[Math.floor(Math.random()*e.length)]}async function getSimilarShows(e,t){const a=`/api/similar/${t=t?"tv":"movie"}/${e}?`;return await fetchData(a+url_params).then((e=>e.results.slice(0,5)))}async function showMoviesTrending(){moviesTrending=await fetchData(url_moviesTrend+url_params),toCarousel(moviesTrending)}function toCarousel(e){gallery.innerHTML="",galleryThumbnails.innerHTML="",e.results.forEach(((e,t)=>{const{title:a,poster_path:n,vote_average:s,backdrop_path:o,overview:r,release_date:i,genre_ids:l,id:c}=e,d=document.createElement("div");d.classList.add("carousel-item"),0===t&&(d.className+=" active"),d.style.backgroundImage=`url("${img_path_highres+o}")`,d.innerHTML=`\n      <div class="fade-overlay"></div>\n      <div class="carousel-caption d-md-block">\n      \x3c!-- <div class="carousel-caption d-none d-md-block"> --\x3e\n        <h2 class="display-4">${a}</h2>\n          <p class="lead overview-header__stats">\n            <span class="carousel-caption-overview">${new Date(i).getFullYear()}</span> \n            <span class="pipe carousel-caption-overview">|</span> \n            <span class="carousel-caption-overview">\n              <i class="${0==s?"":getClassByRate(s).star}"></i> ${0==s?"":s} </span>\n            <span class="pipe carousel-caption-overview">|</span> \n            <span class="carousel-caption-overview">${showMovieListGenres(l)}</span>\n          </p>\n        <div class="film-details">\n          <a class="button-container-${t}" href="#"></a>\n          <p class="lead">${r.substring(0,200)}...</p>\n        </div>\n      </div>\n      `,gallery.appendChild(d);const m=document.createElement("button");m.classList.add("btn-custom"),m.className+=" mb-3",m.innerHTML='<i class="fas fa-play"></i> Play',m.addEventListener("click",(function(){fetchMovie(c)})),document.querySelector(".button-container-"+t).appendChild(m);const u=document.createElement("li");u.setAttribute("data-target","#carousel-main"),u.setAttribute("data-slide-to",`${t}`),u.innerHTML=`\n      <div class="card-dummy">\n        <img src="${img_path+n}">\n      </div>\n    `,marqueeReel.appendChild(u)})),infiniteMarquee()}function toSection(e,t){if(e.innerHTML="",t.length<1)return e.innerHTML='<div class="section-title">No Results Found<span class="section-backlogo">No Results Found</span></div>',!1;e.innerHTML=`\n  <div class="section-row">\n    <div class="section-title">${e.getAttribute("data-desc")}<span class="section-backlogo">${e.getAttribute("data-desc")}</span></div>\n    <div class="view-icons-container">\n      <span class="view-icons btn-view-sm">\n        <svg class="btn-view-sm" width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-grid-3x2-gap" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n          <path class="btn-view-sm" fill-rule="evenodd" d="M4 4H2v2h2V4zm1 7V9a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V4a1 1 0 0 0-1-1H2a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm5 5V9a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zm0-5V4a1 1 0 0 0-1-1H7a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1zM9 4H7v2h2V4zm5 0h-2v2h2V4zM4 9H2v2h2V9zm5 0H7v2h2V9zm5 0h-2v2h2V9zm-3-5a1 1 0 0 1 1-1h2a1 1 0 0 1 1 1v2a1 1 0 0 1-1 1h-2a1 1 0 0 1-1-1V4zm1 4a1 1 0 0 0-1 1v2a1 1 0 0 0 1 1h2a1 1 0 0 0 1-1V9a1 1 0 0 0-1-1h-2z"/>\n        </svg>\n      </span>\n      <span class="view-icons btn-view-lg">\n        <svg class="btn-view-lg" width="1em" height="1em" viewBox="0 0 16 16" class="bi bi-grid" fill="currentColor" xmlns="http://www.w3.org/2000/svg">\n          <path class="btn-view-lg" fill-rule="evenodd" d="M1 2.5A1.5 1.5 0 0 1 2.5 1h3A1.5 1.5 0 0 1 7 2.5v3A1.5 1.5 0 0 1 5.5 7h-3A1.5 1.5 0 0 1 1 5.5v-3zM2.5 2a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 1h3A1.5 1.5 0 0 1 15 2.5v3A1.5 1.5 0 0 1 13.5 7h-3A1.5 1.5 0 0 1 9 5.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zM1 10.5A1.5 1.5 0 0 1 2.5 9h3A1.5 1.5 0 0 1 7 10.5v3A1.5 1.5 0 0 1 5.5 15h-3A1.5 1.5 0 0 1 1 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3zm6.5.5A1.5 1.5 0 0 1 10.5 9h3a1.5 1.5 0 0 1 1.5 1.5v3a1.5 1.5 0 0 1-1.5 1.5h-3A1.5 1.5 0 0 1 9 13.5v-3zm1.5-.5a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z"/>\n        </svg>\n      </span>\n    </div>\n  </div>\n  `,t.forEach(((t,a)=>{const{title:n,poster_path:s,vote_average:o,backdrop_path:r,overview:i,release_date:l,genre_ids:c,id:d}=t,m=document.createElement("div");m.className="movie",m.innerHTML=`      \n      <div class="img-container">\n        <div class="img" style="background-image: url('${img_path+s}');"></div>\n        <div class="overlay"></div>\n      </div>\n      <div class="movie-info">\n        <div class="overview">\n          <div class="overview-header">\n            ${n}<br>\n            <div class="overview-header__stats">\n              <span>${new Date(l).getFullYear()}</span> \n              <span class="pipe">|</span> \n              <span class="${getClassByRate(o).class}">\n                ${o} <i class="${getClassByRate(o).star}"></i></span>\n              </span><br>\n              <span class="genres">${showMovieListGenres(c)}</span>\n            </div>\n          </div>\n          \n          <div class="overview-body">\n           \x3c!-- <p>${i}</p> --\x3e\n          </div>\n          <div class="overview-footer">\n          </div>          \n        </div>\n      </div>\n    `,e.appendChild(m),m.addEventListener("click",(function(){fetchMovie(d)}))}))}function toTheaterPicked(e,t){if(e.innerHTML="",t.length)return e.innerHTML='<div class="section-title">No Results Found<span class="section-backlogo">No Results Found</span></div>',!1;const{title:a,poster_path:n,vote_average:s,backdrop_path:o,overview:r,release_date:i,genre_ids:l,id:c}=t,d=document.createElement("div");d.className="pickedMovie",d.style.backgroundImage=`url(${img_path_highres+o})`,d.innerHTML=`\n    <div class="picked-overlay"></div>\n    <div class="info-box parallax-box">\n      <div class="info-box_block">\n        <div class="picked-title">\n          ${a} <span>(${new Date(i).getFullYear()})</span>\n        </div>\n        <div class="details-block">\n          <div>\n            <img src="${img_path+n}" height="220">\n          </div>\n          <div>\n            <span class="genres">${showMovieListGenres(l)}</span>\n            <br>\n            <span class="picked-rating">${s} <i class="${getClassByRate(s).star}"></i></span>\n            <br>\n            <p>${r.substring(0,150)}...</p>\n          </div>\n        </div>\n      </div>\n    </div>\n    <div class="map-box parallax-box">\n      <div>${e.getAttribute("data-desc")}</div>\n      <div id="map">MAP</div>\n      <div class="notes">${e.getAttribute("data-desc-2")}</div>\n    </div>\n  `,e.appendChild(d);d.querySelector(".info-box").addEventListener("click",(()=>fetchMovie(c)));let m=0;const u=()=>{!coordinates&&m<10?(m++,setTimeout((()=>{u()}),200)):initMap(coordinates)};u()}function toMoviePicked(e,t){if(e.innerHTML="",t.length)return void(e.innerHTML='<div class="section-title">No Results Found<span class="section-backlogo">No Results Found</span></div>');const{title:a,poster_path:n,vote_average:s,backdrop_path:o,overview:r,release_date:i,genre_ids:l,id:c}=t,d=document.createElement("div");d.className="picked-movie-similars",d.style.backgroundImage=`url(${img_path_highres+o})`,d.innerHTML=`\n    <div class="picked-overlay"></div>\n    <div class="info-box">\n      ${e.getAttribute("data-desc")}<br>\n      <div class="picked-title">${a} <span>(${new Date(i).getFullYear()})</span></div>\n      <span class="picked-rating">\n        ${s} <i class="${getClassByRate(s).star}"></i></span>\n      </span><br>\n      <span class="genres">${showMovieListGenres(l)}</span>\n    </div>\n    <div class="similars-box">\n    </div>\n    </div>\n  `,e.appendChild(d);d.querySelector(".info-box").addEventListener("click",(()=>fetchMovie(c)));return d.querySelector(".similars-box")}function toSimilars(e,t){e.innerHTML="",t.forEach(((t,a)=>{const{title:n,poster_path:s,vote_average:o,backdrop_path:r,overview:i,release_date:l,genre_ids:c,id:d}=t,m=document.createElement("div");m.className="similars-card",m.innerHTML=`\n      <div class="similars-bg" style="background-image: url(${img_path+r})"></div>\n      <div class="movie-info">\n        <div class="overview">\n          <div class="overview-header">\n            ${n}<br>\n            <div class="overview-header__stats">\n              <span>${new Date(l).getFullYear()}</span> \n              <span class="pipe">|</span> \n              <span>\n                ${o} <i class="${getClassByRate(o).star}"></i></span>\n              </span><br>\n              <span class="genres">${showMovieListGenres(c)}</span>\n            </div>\n          </div>          \n        </div>\n      </div>\n    `,e.appendChild(m),m.addEventListener("click",(function(){fetchMovie(d)}))}))}async function watchMovie(e){const{title:t,poster_path:a,vote_average:n,backdrop_path:s,overview:o,release_date:r,genres:i}=e;clearPage(),header.innerHTML=`\n    \x3c!-- <div class="section-title">Title<span class="section-backlogo">Title</span></div> --\x3e\n    \x3c!-- <h1>Title</h1> --\x3e\n\n    <section class="watch-movie">\n      <div class="watch-movie-bg-decor">${t}</div>\n      <div class="watch-movie-bg"></div>\n      <div class="container">\n        <div class="row">\n          <div class="col-lg-6 col-sm-12 padding-0">\n            <div class="movie-glance">\n              <div class="film-page_poster">\n                <img class="img-fluid" src="${img_path+a}" alt="${t}" title="${t}"> \n              </div>\n              <div class="movie-info-container">\n                <div class="">\n                  <div class="film-page_title">${t}</div>\n                  <div class="film-page_title-stats">\n                    <span>${new Date(r).getFullYear()}</span>\n                    <span>|</span>\n                    <span> R </span>\n                    <span>|</span>\n                    <span> 2hr 20min</span>\n                  </div>\n                </div>\n                <div class="film-page_rating">\n                  <span class="rating-star"><i class="${getClassByRate(n).star}"></i></span>\n                  <span class="rating-score ${getClassByRate(n).class}">${n}</span>\n                  <span class="reviews">87 875 <i class="fas fa-user-alt"></i></span>\n                </div>\n                <div class="film-page_genre">\n                  <span>${showMovieGenres(i)}</span>\n                </div>\n              </div>\n            </div>\n            <div class="movie-sources">\n              <ul class="play-button-group">\n                <li><a href="#" class="btn btn-sm btn-secondary wm-btn">4K <i class="fas fa-play"></i></a></li>\n                <li><a href="#" class="btn btn-sm btn-secondary wm-btn">HD <i class="fas fa-play"></i></a></li>\n                <li><a href="#" class="btn btn-sm btn-secondary wm-btn">SD <i class="fas fa-play"></i></a></li>\n                <li><a href="#" class="btn btn-sm btn-secondary wm-btn">IN THEATERS <i class="fas fa-film"></i></a></li>\n              </ul>\n            </div>\n          </div> \n          <div class="col-lg-6 col-sm-12">\n            <div class="movie-description">\n              <p>${o}</p>\n            </div>  \n          </div> \n        </div>\n        <div class="row">\n        \n          <div class="iframe-container">\n\n          </div>\n        \n        </div>\n      </div>\n    </section>\n\n    <section class="suggest-movie" style="height: 100px;">\n      <div class="container">\n        <div class="title">\n          <h4>You Also May Like</h4>\n        </div>\n      </div>\n    </section>\n  `,window.scrollTo(0,0);const l=document.querySelector(".iframe-container"),c=elem.getAttribute("data-trailer"),d=new URLSearchParams({q:`${t} ${new Date(r).getFullYear()} ${c}`}),m=(await fetchData("/api/youtube/trailers?"+d).then((e=>e.items)))[0].id.videoId;l.innerHTML=`\n    <iframe src="https://www.youtube.com/embed/${m}?autoplay=1&start=13&mute=1" \n    allow="autoplay; picture-in-picture;" frameborder="0" allowfullscreen>\n    </iframe> \n  \n  `}function toGenresList(e,t){t.innerHTML="",e.forEach((e=>{const{id:a,name:n}=e,s=document.createElement("li");s.classList.add("genre-li"),s.innerHTML=`<a href="javascript:void(0)">${n.length>16?n.substring(0,16)+"...":n}</a>`,t.appendChild(s),s.addEventListener("click",(async function(){const e=new URLSearchParams({language:language});e.append("with_genres",a);const t=await fetch("api/genres?"+e).then((e=>e.json()));clearPage();toSection(document.querySelector(".search-results"),t.results)}))}))}function infiniteMarquee(){const e=document.documentElement,t=getComputedStyle(e).getPropertyValue("--marquee-elements-displayed"),a=document.querySelector(".marquee-content");e.style.setProperty("--marquee-elements",a.children.length);for(let e=0;e<t;e++)a.appendChild(a.children[e].cloneNode(!0))}function contactForm(){document.getElementById("contact-form").addEventListener("submit",(async e=>{e.preventDefault();const t=document.querySelector("#contact-form-name").value,a=document.querySelector("#contact-form-email").value,n=document.querySelector("#contact-form-message").value,s=await fetch("/info/contact",{method:"POST",headers:{"Content-type":"application/json"},body:JSON.stringify({name:t,email:a,message:n})}),o=await s.json();console.log(o)}))}"/"==window.location.pathname&&document.addEventListener("DOMContentLoaded",initData()),document.addEventListener("click",(e=>{"btn-view-sm"==e.target.classList&&(document.querySelector(".btn-view-sm").style.opacity=1,document.querySelector(".btn-view-lg").style.opacity=.6,document.querySelectorAll(".movie").forEach((e=>{e.className="movie-small"}))),"btn-view-lg"==e.target.classList&&(document.querySelector(".btn-view-sm").style.opacity=.6,document.querySelector(".btn-view-lg").style.opacity=1,document.querySelectorAll(".movie-small").forEach((e=>{e.className="movie"})))})),console.log("connected 5_marquee.js"),console.log("connected 6_forms.js"),"/info/contact"==window.location.pathname&&document.addEventListener("DOMContentLoaded",contactForm()),console.log("connected 2.1_regvalidate.js");const regform=document.querySelector("#reg-form"),regemail=document.querySelector("#reg-email"),regpassword=document.querySelector("#reg-password"),regcaptcha=document.querySelector("#reg-form .g-recaptcha"),emailsmall=document.querySelector("#reg-form .email-small"),emailerr=document.querySelector("#reg-form .email-error"),captchasmall=document.querySelector("#reg-form .captcha-small"),loginForm=document.querySelector("#login-form"),loginemail=document.querySelector("#login-email"),loginCaptcha=document.querySelector("#login-form .g-recaptcha"),loginBtn=document.querySelector("#btn-login"),loginEmailsmall=document.querySelector("#login-form .email-small"),loginCaptchasmall=document.querySelector("#login-form .captcha-small");let registrationErrors={emailbackend:!0,email:!0,password:!0,recaptcha:!0},loginErrors={email:!0};function setErrorFor(e,t){const a=e.parentElement;a.querySelector(".small").innerText=t,a.className="form-group error"}function setSuccessFor(e){e.parentElement.className="form-group success"}function isEmail(e){return/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/.test(e)}function checkEmail(){let e=document.querySelector("#reg-email").value.toLowerCase();fetch("/usercheck",{method:"post",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e})}).then((e=>e.json())).then((e=>{if(console.log(e),"success"!=e.message){emailsmall.innerHTML=`${e.message}`;emailsmall.parentElement.className="form-group error",registrationErrors.emailbackend=!0}else registrationErrors.emailbackend=!1}))}function allFalse(e){for(let t in e)if(e[t])return!1;return!0}function validateEmail(e){const t=e.value;""===t||null===t?(setErrorFor(e,"Email cannot be blank"),registrationErrors.email=!0,loginErrors.email=!0):t.length<=6?(setErrorFor(e,"Email too short"),registrationErrors.email=!0,loginErrors.email=!0):isEmail(t)?(setSuccessFor(e),registrationErrors.email=!1,loginErrors.email=!1):(setErrorFor(e,"Email is not valid"),registrationErrors.email=!0,loginErrors.email=!0)}function validatePassword(){passValue=regpassword.value,""===passValue||null===passValue?(setErrorFor(regpassword,"Password cannot be blank"),registrationErrors.password=!0):passValue.length<=6?(setErrorFor(regpassword,"Password must be 7+ characters"),registrationErrors.password=!0):(setSuccessFor(regpassword),registrationErrors.password=!1)}function validateCaptcha(){regemail.value;0!=registrationErrors.recaptcha?setErrorFor(regcaptcha,"Are you human? Please check captcha"):setSuccessFor(regcaptcha)}function recaptchaCheck(){registrationErrors.recaptcha=!1,setSuccessFor(regcaptcha)}function recaptchaCheckExp(){registrationErrors.recaptcha=!0,setErrorFor(regcaptcha,"Are you human?")}function calPasswordStrength(e){var t=0;if(!e)return t;for(var a=new Object,n=0;n<e.length;n++)a[e[n]]=(a[e[n]]||0)+1,t+=5/a[e[n]];var s={digits:/\d/.test(e),lower:/[a-z]/.test(e),upper:/[A-Z]/.test(e),nonWords:/\W/.test(e)};for(var o in variationCount=0,s)variationCount+=1==s[o]?1:0;return t+=10*(variationCount-1),parseInt(t)}regemail.addEventListener("focusin",(()=>{registrationErrors.emailbackend=!0})),document.querySelectorAll(".auth-form").forEach((e=>{const t=e.querySelector(".submit-loader"),a=e.querySelector(".auth-btn");e.addEventListener("submit",(n=>"reg-form"!==e.id||allFalse(registrationErrors)?"login-form"!==e.id||(validateEmail(loginemail),allFalse(loginErrors))?(a.disabled=!0,a.style.pointerEvents="none",a.style.opacity=.3,void(t.innerHTML='\n      <?xml version="1.0" encoding="utf-8"?>\n      <svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" style="margin: auto; background: none; display: block; shape-rendering: auto;" width="50px" height="50px" viewBox="0 0 100 100" preserveAspectRatio="xMidYMid">\n      <path d="M10 50A40 40 0 0 0 90 50A40 43 0 0 1 10 50" fill="#ececec" stroke="none">\n        <animateTransform attributeName="transform" type="rotate" dur="1s" repeatCount="indefinite" keyTimes="0;1" values="0 50 51.5;360 50 51.5"></animateTransform>\n      </path>\n      \x3c!-- [ldio] generated by https://loading.io/ --\x3e</svg>\n    ')):(n.preventDefault(),console.log("login-form validation"),console.log(loginErrors),console.log(allFalse(loginErrors)),!1):(n.preventDefault(),validateEmail(regemail),validatePassword(),validateCaptcha(),checkEmail(),console.log("reg-form validation"),console.log(registrationErrors),console.log(allFalse(registrationErrors)),!1)))})),regemail.addEventListener("focusout",(()=>{checkEmail()})),regemail.addEventListener("keyup",(e=>{validateEmail(regemail)})),loginemail.addEventListener("focusout",(e=>{validateEmail(loginemail)})),regpassword.addEventListener("keyup",(e=>{validatePassword()})),console.log("connected 2.2_pwmeter.js"),document.querySelector("#reg-password").addEventListener("keyup",(function(){const e=document.getElementById("passwordmessage"),t=document.querySelectorAll(".pwmeter span");let a=calPasswordStrength(this.value);a<=40?(t[0].style.backgroundColor="red",t[0].className="meter-span-on",t[1].className="meter-span-off",t[2].className="meter-span-off",e.style.color="coral",e.innerHTML="Weak password"):a<=77?(t[1].style.backgroundColor="orange",t[1].className="meter-span-on",t[2].className="meter-span-off",e.style.color="orange",e.innerHTML="Password is average"):(t[2].style.backgroundColor="green",t[2].className="meter-span-on",e.style.color="green",e.innerHTML="Your password is strong"),""==this.value&&(t[0].className="meter-span-off",t[1].className="meter-span-off",t[2].className="meter-span-off",e.innerHTML="")})),console.log("connected 4.5_profile.js");const url_weatherInfo="/api/weather?",weather=document.querySelector(".weather-data"),clientInfo=document.querySelector(".client-data");async function profileInit(){const e=await sessionIpData("https://freegeoip.app/json/");showWeather(e),showClientside(e)}async function showWeather(e){if(weather){const t=new URLSearchParams({lat:e.latitude,lon:e.longitude,units:"metric",lang:language});toWeather(await fetchData("/api/weather?"+t))}}async function showClientside(e){if(clientInfo){1,toClientInfo(e)}}function toWeather(e){if(e.length<1)return weather.innerHTML="",void(weather.innerHTML="<div>No Weather Data</div>");weather.innerHTML="",weather.innerHTML="<div><strong>Weather Info with OpenWeatherMap:</strong></div>";const t=e.locale,a=e.name,n=e.main.temp,s=e.weather[0].icon,o=e.weather[0].description,r=document.createElement("div");r.classList.add("weather"),r.innerHTML=`\n    ${t.city}: ${a}<br>\n    ${t.temp}: ${n} &deg;C <br>\n    ${o}<br>\n    <img class="weather-icon" src="http://openweathermap.org/img/wn/${s}@2x.png"> <br>\n  `,weather.appendChild(r),r.addEventListener("click",(function(){}))}function toClientInfo(e){const t=document.querySelectorAll(".client-data span");t[0].innerHTML=e.ip,t[1].innerHTML=e.latitude,t[2].innerHTML=e.longitude,t[3].innerHTML=e.city,t[4].innerHTML=e.country_name,t[5].innerHTML=e.time_zone}let map,marker,activeInfoWindow,myLatLng,directionsService,directionsRenderer;async function initMap(e){myLatLng={lat:e.lat,lng:e.lon};const t=toggleSwitch.checked?styles.night:styles.retro,a=toggleSwitch.checked?"/img/marker-light.png":"/img/marker-dark.png",n=new URLSearchParams({language:language});n.append("location",`${e.lat},${e.lon}`),n.append("radius","2500"),n.append("type","movie_theater");const s=await fetchData("/api/places?"+n);directionsService=new google.maps.DirectionsService,directionsRenderer=new google.maps.DirectionsRenderer,map=new google.maps.Map(document.getElementById("map"),{center:myLatLng,zoom:13,disableDefaultUI:!0,styles:t}),directionsRenderer.setMap(map),marker=new google.maps.Marker({position:myLatLng,map:map,animation:google.maps.Animation.DROP,title:"Your data shows you are here!",icon:{url:a,scaledSize:new google.maps.Size(40,40)}}),marker.addListener("mouseover",toggleBounce),marker.addListener("mouseout",toggleBounce),s.forEach((e=>{addMarker(e)})),google.maps.event.addDomListener(toggleSwitch,"change",(function(e){e.target.checked?(map.setOptions({styles:styles.night}),marker.setOptions({icon:{url:"/img/marker-light.png",scaledSize:new google.maps.Size(40,40)}})):(map.setOptions({styles:styles.retro}),marker.setOptions({icon:{url:"/img/marker-dark.png",scaledSize:new google.maps.Size(40,40)}}))}))}function toggleBounce(){null!==marker.getAnimation()?marker.setAnimation(null):marker.setAnimation(google.maps.Animation.BOUNCE)}function addMarker(e){let t=new google.maps.Marker({position:e.geometry.location,map:map,icon:{url:e.icon,scaledSize:new google.maps.Size(20,20)},title:e.name});const a=`\n    <div><h3>${e.name}</h3></div>\n    <div>🚩 ${e.vicinity}</div>\n    <div>⭐ ${e.rating} (${e.user_ratings_total})</div><br>\n    <div><button id="router-btn" class="btn-custom">Route</button></div>\n  `,n=new google.maps.InfoWindow({content:a});google.maps.event.addListener(n,"domready",(()=>{document.getElementById("router-btn").addEventListener("click",(()=>{calculateAndDisplayRoute(directionsService,directionsRenderer,e.geometry.location)}))})),t.addListener("click",(()=>{activeInfoWindow&&activeInfoWindow.close(),n.open(map,t),activeInfoWindow=n}))}function calculateAndDisplayRoute(e,t,a){activeInfoWindow&&activeInfoWindow.close(),e.route({origin:myLatLng,destination:a,avoidTolls:!0,avoidHighways:!1,travelMode:google.maps.TravelMode.DRIVING},((e,a)=>{"OK"===a?t.setDirections(e):window.alert("Directions request failed due to "+a)}))}-1!=window.location.href.indexOf("/profile/")&&document.addEventListener("DOMContentLoaded",profileInit()),console.log("gmap.js");const styles={default:[{icon:"purple"}],night:[{icon:"orangered"},{elementType:"geometry",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.stroke",stylers:[{color:"#242f3e"}]},{elementType:"labels.text.fill",stylers:[{color:"#746855"}]},{featureType:"administrative.locality",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"poi.park",elementType:"geometry",stylers:[{color:"#263c3f"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#6b9a76"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#38414e"}]},{featureType:"road",elementType:"geometry.stroke",stylers:[{color:"#212a37"}]},{featureType:"road",elementType:"labels.text.fill",stylers:[{color:"#9ca5b3"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#746855"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#1f2835"}]},{featureType:"road.highway",elementType:"labels.text.fill",stylers:[{color:"#f3d19c"}]},{featureType:"transit",elementType:"geometry",stylers:[{color:"#2f3948"}]},{featureType:"transit.station",elementType:"labels.text.fill",stylers:[{color:"#d59563"}]},{featureType:"water",elementType:"geometry",stylers:[{color:"#17263c"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#515c6d"}]},{featureType:"water",elementType:"labels.text.stroke",stylers:[{color:"#17263c"}]}],retro:[{icon:"purple"},{elementType:"geometry",stylers:[{color:"#ebe3cd"}]},{elementType:"labels.text.fill",stylers:[{color:"#523735"}]},{elementType:"labels.text.stroke",stylers:[{color:"#f5f1e6"}]},{featureType:"administrative",elementType:"geometry.stroke",stylers:[{color:"#c9b2a6"}]},{featureType:"administrative.land_parcel",elementType:"geometry.stroke",stylers:[{color:"#dcd2be"}]},{featureType:"administrative.land_parcel",elementType:"labels.text.fill",stylers:[{color:"#ae9e90"}]},{featureType:"landscape.natural",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"poi",elementType:"labels.text.fill",stylers:[{color:"#93817c"}]},{featureType:"poi.park",elementType:"geometry.fill",stylers:[{color:"#a5b076"}]},{featureType:"poi.park",elementType:"labels.text.fill",stylers:[{color:"#447530"}]},{featureType:"road",elementType:"geometry",stylers:[{color:"#f5f1e6"}]},{featureType:"road.arterial",elementType:"geometry",stylers:[{color:"#fdfcf8"}]},{featureType:"road.highway",elementType:"geometry",stylers:[{color:"#f8c967"}]},{featureType:"road.highway",elementType:"geometry.stroke",stylers:[{color:"#e9bc62"}]},{featureType:"road.highway.controlled_access",elementType:"geometry",stylers:[{color:"#e98d58"}]},{featureType:"road.highway.controlled_access",elementType:"geometry.stroke",stylers:[{color:"#db8555"}]},{featureType:"road.local",elementType:"labels.text.fill",stylers:[{color:"#806b63"}]},{featureType:"transit.line",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"transit.line",elementType:"labels.text.fill",stylers:[{color:"#8f7d77"}]},{featureType:"transit.line",elementType:"labels.text.stroke",stylers:[{color:"#ebe3cd"}]},{featureType:"transit.station",elementType:"geometry",stylers:[{color:"#dfd2ae"}]},{featureType:"water",elementType:"geometry.fill",stylers:[{color:"#b9d3c2"}]},{featureType:"water",elementType:"labels.text.fill",stylers:[{color:"#92998d"}]}],hiding:[{featureType:"poi.business",stylers:[{visibility:"off"}]},{featureType:"transit",elementType:"labels.icon",stylers:[{visibility:"off"}]}]};
//# sourceMappingURL=main.min.js.map
